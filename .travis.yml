language: java
jdk: oraclejdk8
services:
- docker
branches:
  except:
  - "/^[0-9]/"
before_script:
- git config --global user.name "${GIT_USER_NAME}"
- git config --global user.email "${GIT_USER_EMAIL}"
- cp .travis.settings.xml $HOME/.m2/settings.xml
script:
- export ARTID=$(mvn -q -Dexec.executable=echo -Dexec.args='npiper/${project.artifactId}' --non-recursive exec:exec)
- mvn clean install jib:dockerBuild -Drevision=${TRAVIS_BUILD_NUMBER}.$(git rev-parse --short HEAD) -Dimage=${ARTID}
after_success:
- test $TRAVIS_BRANCH = "master" && test $TRAVIS_PULL_REQUEST = "false" && mvn site deploy scm:tag -DskipTests -Drevision=${TRAVIS_BUILD_NUMBER}.$(git rev-parse --short HEAD) -Dusername="${GIT_USER_NAME}" -Dpassword="${GITPW}"
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
- docker images
- docker push ${ARTID}
env:
  global:
  - secure: Ne0GCbBuip31i1pN0TbdWCXrDfP2RPFKZiaAO+azBjD2VAT3MYBCBx+7+6tvtqLY/7OM99sdjR5C7cn68aGA4hEuDiyYiEF8OrS2I/npjEtqivMwN9cBNbXMzBtIESkxuyNL5lqCxN+UNeZgTS2yybUcVUrKvqDLpvYjK5//7cRTPMuFM3gyN+vvI7Luzzujy00v7X3e7kxo3cP9Fyw8EgfnsMwJUmVp0Yg7x3jX73Y96j4ibDD/5oLV6CPpf9BLPLa/NN//Ne7Q0Nwx7wZRMlDyVv0i47Gh+cz2qzZtHUMJF/Mmxg6QS0Q5qMIm7gsPG7FPi96RqHVcxJntgxGG55niZVw358usTVOUI7CcqiJkDR3c5/jvbnJlm5JNwgUS57lyhmHHMfPQ7f4NRY3jlw2BWbwAAxX3O4p3YfexWATja+NHQuZ2jiklLJawJ268G8Wxk53Q/csQUklPKPC9QyC3wF5yTLwCBdo8GuUMyHN1Bw9AiJODDW3O55e10OM75b8WGcXXkM4LtOiPSRYxe4zjtaav3xx4vuFRqWDr29Yahlpu+WNfJrBNGn5qaU6J3yfjbXoQBDg1ondxTh47n5M5btLT6Phk6sH0HUhXioxwrF9ss3TRp9xEfJUl8eKjnvDMzYcS92Sb2GQymIOw8cy42lG4izYu0yFdHNHU13M=
  - secure: KOIYdYf0sRwJatXpZtei6M8DStTXp7z4S9/9z+aRjXricG2OQfyuJBa6EshqDU4cI2gvle4dpRxVffTTujie0UVKaZn0CsXJSYvV9MQVJsjMC42Mnh4u/fNIDg7dS57HKL9oeSozv28iY7DwZfB766gGlWAI0YByXRcu2jBCSnRQzEuNm6nkut9LsONOVMS4CweYnQfivDjvogj9KbsYM91+ahOIGv0JokteRYlmMYqeCazL/eglMo8GV9owUeMPNLu9tGeK/6FDMU1MXM9mR8Ut3tfspZzMcM8sRJVnt8sZARoidAIRi8tYm4PQ1Fd1xtaXD+cp9Xaazw08TC7uBMCCm4cnbKOlUTrrLvGXbVMO+SMhuvztpUHOLTfsf/yXitWx1rDfzegOmRJSnv/pCV6Iifyk/vBSJTBGJvUDRfRpMZm9TdEIXU9ykwKvl/gWsWvSLvCQrkFfHz4T8tQpA/y/2OxivwqmLGpU4Xy15ClGor+BhfRp5cxafUMsscQ8HQv9oqB+uaLtOEsNexpOkfUdzKB0RdfEm/pf0Vg63uzBFz/8iEabXve2xiA3/JvSnRsO7MYGw9da0YYbKdojrq6eHuh0Hxjee0AXrdbAtXIpfymCPLGVY3qrkWhiRy/R++F+Rgcp2KpNIQBQmWBJo8TFLw9ZTZfHbq8IQjn8tI8=
  - secure: Lh5H6XuidAjQ37IHaXJvKALhav5MlClp5jrJ39Br1yp8+8F/XdkITp4VHs5IueifyDB2fXdHJnuiZFRzhD/5fIKXzo8W0aLLgdp5/ePRgwywYINk2DEvtUc/AHIJvdFBGM7u5o8wkieyLMii7/tQ3eO5l1yyJ2cS78fIEqM80JRwf0icDkmF3SI508Kp2edqVsKxxCYDdKuKcSM/ftpijENS2pzBQ3/yqVv3xx3d9YL+b7yoIZItnW5AlnNcQhYODvqF3e4Z90H27CdYfYn5FbjIYA7J05MYqR8+e2fSgkB2yQuTXNrOD6mkGOJsEiUoGx5lO3m02HiRIFsxitPGaWCVElud7kAmIluB4Mn5OG386kFZdFUAUXPD2yzGEf4OeW53lVR257JngNd2O5wvxQT5JFk8ZjPWrW5E1Dw8VjkHYgy0DMi7P1jMATAhF5vGM7i/B4IRxTI3npUOJK4kwzDiXUDfzXNGFHjb20I2xkujkLsDj1M+AMDVicyrS/gaD7BKIuP1iZcvkAzGrDMXuidGUBu9szwvxJl5zBL2yPseUza9XbdArz0DE9Ei+8p0Xtflq/Zk4XwHgXXEov0ANM2CIrC2XZGxWLXDnMMhfCfBLhvejXaLx4FEO49ow4C4Ri9RxWvDbsgCH+vLbsRRN7phVOhqZQxHmPxj2dAJ+d8=
  - secure: DXSvKIpHMJKT9BaxrJVYtZofhMOES5Jknj5YQ9RO189UdWm9cSaB1kjOK+C8du8bqNvs+73TPqIknLM4gCw/fp7xgX+Rqrx1LCfUrwcQ4W9WB07a+LtpD7+qe0oXMMxhIFkdRSbS5qUsJ5XurnVsdt1q4nC77bJYQJkOFZW70Z0VyyuWIAUVSX/gv7A0/HZiFFc8JEjMq7t+Ds1bKNl1dxfJITl+aTDpayX/ZoLQ+R3qMVR9A15segxcd/0L0bkQbACxzqzA1IObSvY99i6U+unS80ydECB8QPXibeIR2ILefX0qUGNN68UYRQdrwUHe3GXMjoCPm1WheGIw350KG4YIoO8B6uXWgFwgdvY5bbVWzv5+eVySjLzrbL2ercVi702bYTyZkg0eZ5/RkSJH+9ytARc11BQLRwqPlzr44TbW+5NEwaHQBVhbNDBbD4Sk8to36yIu7tE8l0td4xDwAqh8Kc4auK584xIRmeNWffXXx6KkOqrmRs5MgZg+KjNSRkOYVmmbxDdD2OaqG5QjuTPu9SY6IqWqG/1F2zFQmPkQeg3dEdDQHlOMRAjWB0GcYB69KZNOAbCaOArHhQBMTtAFoaofRr8EG99MqrOVVxKiHuuFByZB37hD9rFN2Tp9A/G67R/NY/6NgUWgMa5laQK6feAPXAyiHao80mLjH5A=
DOCKER_USERNAME:
  secure: YEmDBw14mtrcFjN12isIk1HUv05gzh302wyVSHuZlsHXjONeew8CfTVkX6XTx1mFxVRqKF+2IkzZf0lDB9ogwJzmmgWP9xFFrC6APR5Wnyxx0qkoTzDuIv3lS3t6+uhVC804UtmrKIQ4EDuU4JkM39JHT6iT24jxZNkaobpiPa/ZIU3xuSEA/RdZw/SGaZB25uSa6mLq3fLYTCknx+tzCzLB9d7EB1U7tb9buDsJwT6GkEU0NWp8lku8p15TMoJNgUCyXGPC0oCQrQCGSAR2Rt9erj8lhq4+SG/pl1EQ7e6qq4eYh2dAJlBqvbgxVtWwPEar6O53ldXBEtkbpLUhVszxCWIV/siO9SVuH1CTSjqv/OpZJLYBx7vTrCavihLcDMWkn2enIfFaduacTQwQQPe8yCP5Vt6OKh7g7Qa+FhVS+nocf/vLwhqvEnJkq+V2va7ezrwe+/j6hqFUUSY/8wvQsbx6fxWWiLZ7sxF4LIN5qMhWUQmG/i17CrWJFtYykchJHjmnKZB3un/4v5yt8vFditSA+zns5zlK5MhlQxNHmRtp2xQgEdd24q6B7kLLcUchk2fyp7dH/sGi9qryFyjGdR5rOtA/PrmP6dumHvCGZjndmFViP+Ag1Gw3TuFXGfO+1sjOnIO2LebKFpjDw0ZfV6Z+q5hWUaOGNLb9j9M=
DOCKER_PASSWORD:
  secure: eg+VtO/PF3vGxyt3ZCmiRBF954TWbkV5XSmi6D5lxRciniURr8YtNm8qzsTCw1NmQO9/oNZ/2D8xerW11b6eHuz2GaXuPikQSRiINxRS6AfchhhDfWFwKlJU9QvM/zY56G4avSVVLbZ+PoXw0iWJHlY0km5I+FNcbIwO40HUs/vP5Zmqqv89oShBEySzuQn1zzJoWW6t7zWZ4thNNjC9ZgUB1cI1v/rCQdDcciVitykDaRpaUK3esX67jqy8a+Ls7MWRcbWypsqSOsq1qLwB/syN8Rlov2SXw8XphjmbOwv6iUjp9laKccsdUQqJhmako3raWqLKRNvRwGgV8Fj8j+J/jGKZFjKEJfvYOu1g9RXi5txMwd7zTKG7fN2mhmc4kcIkjnYFrvYvJMa1NFvk2TwYuTHhj0QvnZa4BMN8T6Ik3AEHWHwItMfW5BE6Lujr3CId3dUvWYbu1wDyoB/JmJA6PRLVTgFmMaoADVm278oX9MOe2kXX6efVIeN7KHL5e00xVIGTO62QC5l8wj27aE/tV6EH7Bs3JHMcdZ/PHFv9lzzU/2dtuWqSGuCltVC1SaEYIMvgLl/tX6dKY1uYlXVBTVuU/zjYRkNzBlObF9nfJ2uHCpuSgTfxyTVPLDiToUKU9Lbg2R/uxNQV/QfCYPGPP4wb5hepfl7CzPznVhI=
